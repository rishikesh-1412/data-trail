{"ast":null,"code":"var _jsxFileName = \"/Users/rishikeshmungase/Desktop/Pubmatic/React/data_trail/client/src/Graph.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from \"react\"; // add useState, useEffect\n// ... keep other imports\nimport ReactFlow, { MiniMap, Controls, Background, useNodesState, useEdgesState, MarkerType } from \"reactflow\";\nimport dagre from \"dagre\";\nimport \"reactflow/dist/style.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Graph({\n  productName = \"Audience\"\n}) {\n  _s();\n  // optional prop for productName\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const [loading, setLoading] = useState(true); // loading state\n\n  useEffect(() => {\n    setLoading(true);\n    fetch(`http://localhost:5000/datatrail/product/${productName}`).then(res => res.json()).then(data => {\n      // data should be [{view: \"\", input: \"\"}, ...]\n      const nodeIds = [...new Set(data.flatMap(d => [d.view, d.input]))];\n      const rawNodes = nodeIds.map(id => ({\n        id,\n        data: {\n          label: id\n        },\n        position: {\n          x: 0,\n          y: 0\n        },\n        style: {\n          padding: 10,\n          borderRadius: 8,\n          background: \"linear-gradient(135deg,rgb(165, 228, 244) 0%,rgb(207, 171, 243) 100%)\",\n          color: \"rgb(10, 2, 1)\",\n          fontSize: 18,\n          fontWeight: 600,\n          minWidth: 370,\n          height: 100,\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          overflowX: \"auto\",\n          whiteSpace: \"nowrap\",\n          cursor: \"grab\"\n        }\n      }));\n      const rawEdges = data.map(d => ({\n        id: `e-${d.input}->${d.view}`,\n        source: d.input,\n        target: d.view,\n        animated: false,\n        style: {\n          stroke: \"grey\",\n          strokeWidth: 2\n        },\n        markerEnd: {\n          type: MarkerType.ArrowClosed,\n          color: \"grey\"\n        }\n      }));\n      const {\n        nodes: layoutedNodes,\n        edges: layoutedEdges\n      } = getLayoutedElements(rawNodes, rawEdges);\n      setNodes(layoutedNodes);\n      setEdges(layoutedEdges);\n      setLoading(false);\n    }).catch(err => {\n      console.error(err);\n      setLoading(false);\n    });\n  }, [productName, setEdges]);\n  const parentMap = buildParentMap(edges);\n  const onNodeClick = useCallback((_, node) => {\n    const ancestorEdges = getAllAncestors(node.id, parentMap);\n    setEdges(eds => eds.map(e => {\n      const isHighlighted = ancestorEdges.some(ae => ae.source === e.source && ae.target === e.target);\n      if (isHighlighted) {\n        return {\n          ...e,\n          animated: true,\n          style: {\n            stroke: \"red\",\n            strokeWidth: 4,\n            strokeDasharray: \"5 5\"\n          },\n          markerEnd: {\n            type: MarkerType.ArrowClosed,\n            color: \"violet\"\n          }\n        };\n      }\n      return {\n        ...e,\n        animated: false,\n        style: {\n          stroke: \"grey\",\n          strokeWidth: 2\n        },\n        markerEnd: {\n          type: MarkerType.ArrowClosed,\n          color: \"grey\"\n        }\n      };\n    }));\n  }, [setEdges, parentMap]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 20,\n        fontSize: 20,\n        fontWeight: 600\n      },\n      children: \"Rendering Graph...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: \"100vw\",\n      height: \"81vh\"\n    },\n    children: /*#__PURE__*/_jsxDEV(ReactFlow, {\n      nodes: nodes,\n      edges: edges,\n      onNodesChange: onNodesChange,\n      onEdgesChange: onEdgesChange,\n      onNodeClick: onNodeClick,\n      minZoom: 0.3,\n      maxZoom: 5,\n      fitView: true,\n      nodesDraggable: true,\n      children: [/*#__PURE__*/_jsxDEV(MiniMap, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Controls, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Background, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n}\n_s(Graph, \"6qoW84i1Lj/RqUeWO5dxWQkyxOY=\", false, function () {\n  return [useNodesState, useEdgesState];\n});\n_c = Graph;\nvar _c;\n$RefreshReg$(_c, \"Graph\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","ReactFlow","MiniMap","Controls","Background","useNodesState","useEdgesState","MarkerType","dagre","jsxDEV","_jsxDEV","Graph","productName","_s","nodes","setNodes","onNodesChange","edges","setEdges","onEdgesChange","loading","setLoading","fetch","then","res","json","data","nodeIds","Set","flatMap","d","view","input","rawNodes","map","id","label","position","x","y","style","padding","borderRadius","background","color","fontSize","fontWeight","minWidth","height","display","alignItems","justifyContent","overflowX","whiteSpace","cursor","rawEdges","source","target","animated","stroke","strokeWidth","markerEnd","type","ArrowClosed","layoutedNodes","layoutedEdges","getLayoutedElements","catch","err","console","error","parentMap","buildParentMap","onNodeClick","_","node","ancestorEdges","getAllAncestors","eds","e","isHighlighted","some","ae","strokeDasharray","children","fileName","_jsxFileName","lineNumber","columnNumber","width","minZoom","maxZoom","fitView","nodesDraggable","_c","$RefreshReg$"],"sources":["/Users/rishikeshmungase/Desktop/Pubmatic/React/data_trail/client/src/Graph.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\"; // add useState, useEffect\n// ... keep other imports\nimport ReactFlow, {\n  MiniMap,\n  Controls,\n  Background,\n  useNodesState,\n  useEdgesState,\n  MarkerType,\n} from \"reactflow\";\nimport dagre from \"dagre\";\nimport \"reactflow/dist/style.css\";\n\nexport default function Graph({ productName = \"Audience\" }) { // optional prop for productName\n  const [nodes, setNodes, onNodesChange] = useNodesState([]);\n  const [edges, setEdges, onEdgesChange] = useEdgesState([]);\n  const [loading, setLoading] = useState(true); // loading state\n\n  useEffect(() => {\n    setLoading(true);\n    fetch(`http://localhost:5000/datatrail/product/${productName}`)\n      .then((res) => res.json())\n      .then((data) => {\n        // data should be [{view: \"\", input: \"\"}, ...]\n        const nodeIds = [...new Set(data.flatMap((d) => [d.view, d.input]))];\n\n        const rawNodes = nodeIds.map((id) => ({\n          id,\n          data: { label: id },\n          position: { x: 0, y: 0 },\n          style: {\n            padding: 10,\n            borderRadius: 8,\n            background:\n              \"linear-gradient(135deg,rgb(165, 228, 244) 0%,rgb(207, 171, 243) 100%)\",\n            color: \"rgb(10, 2, 1)\",\n            fontSize: 18,\n            fontWeight: 600,\n            minWidth: 370,\n            height: 100,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            overflowX: \"auto\",\n            whiteSpace: \"nowrap\",\n            cursor: \"grab\",\n          },\n        }));\n\n        const rawEdges = data.map((d) => ({\n          id: `e-${d.input}->${d.view}`,\n          source: d.input,\n          target: d.view,\n          animated: false,\n          style: { stroke: \"grey\", strokeWidth: 2 },\n          markerEnd: { type: MarkerType.ArrowClosed, color: \"grey\" },\n        }));\n\n        const { nodes: layoutedNodes, edges: layoutedEdges } = getLayoutedElements(\n          rawNodes,\n          rawEdges\n        );\n\n        setNodes(layoutedNodes);\n        setEdges(layoutedEdges);\n        setLoading(false);\n      })\n      .catch((err) => {\n        console.error(err);\n        setLoading(false);\n      });\n  }, [productName, setEdges]);\n\n  const parentMap = buildParentMap(edges);\n\n  const onNodeClick = useCallback(\n    (_, node) => {\n      const ancestorEdges = getAllAncestors(node.id, parentMap);\n\n      setEdges((eds) =>\n        eds.map((e) => {\n          const isHighlighted = ancestorEdges.some(\n            (ae) => ae.source === e.source && ae.target === e.target\n          );\n\n          if (isHighlighted) {\n            return {\n              ...e,\n              animated: true,\n              style: {\n                stroke: \"red\",\n                strokeWidth: 4,\n                strokeDasharray: \"5 5\",\n              },\n              markerEnd: { type: MarkerType.ArrowClosed, color: \"violet\" },\n            };\n          }\n\n          return {\n            ...e,\n            animated: false,\n            style: { stroke: \"grey\", strokeWidth: 2 },\n            markerEnd: { type: MarkerType.ArrowClosed, color: \"grey\" },\n          };\n        })\n      );\n    },\n    [setEdges, parentMap]\n  );\n\n  if (loading) {\n    return (\n      <div style={{ padding: 20, fontSize: 20, fontWeight: 600 }}>\n        Rendering Graph...\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ width: \"100vw\", height: \"81vh\" }}>\n      <ReactFlow\n        nodes={nodes}\n        edges={edges}\n        onNodesChange={onNodesChange}\n        onEdgesChange={onEdgesChange}\n        onNodeClick={onNodeClick}\n        minZoom={0.3}\n        maxZoom={5}\n        fitView\n        nodesDraggable\n      >\n        <MiniMap />\n        <Controls />\n        <Background />\n      </ReactFlow>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}